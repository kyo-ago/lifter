language: objective-c
cache:
  directories:
    - node_modules
env:
  - NODE_VERSION="8"
notifications:
  email: false
before_install:
  - git clone https://github.com/creationix/nvm.git /tmp/.nvm
  - source /tmp/.nvm/nvm.sh
  - nvm install $NODE_VERSION
  - nvm use --delete-prefix $NODE_VERSION
  - rvm get stable
  - node --version
install:
  - npm install
script:
  - npm run build
  - npm test
before_deploy:
  - brew update
  - brew install wine
  - wine --version
  - brew install makensis
  - npm run dist
deploy:
  provider: releases
  api_key:
    secure: bpEGBsMYkUqWJVvkRlg52pbf+7IfFHuE8vvBVAsJiLIuO8WsnYy95YuUoD+Z4pLIXhHfrnfl7NWlCqo3l/2B9v/HJ6HU+AERKXSkuFqAQKRBOIWz37fTFTio6PfdZlUwu47E2y9feVEGzvAz5ruQj9ViXBdFrUb5VU9sMe2vrQqrF+4Dq84Ogyi6BAQPxRtS63QRhw5bbZidjfEF51L8FphmAXogjaYS3Y/WTSxRxKmPyIODwkG1xu4WJHaXo0sZt3kVaDV20Ok0aqClUNKYq/BLXTOZ4EZoHp/QjFMieXwK6g0R8m798g04w20Yx05rAWJijS1Bfg9+hgf6iESz0NGvRz0KMewI+Jbi/+71A3w2z/wmpnaaTQtklgWy1K3iVNevOg6Wf8gSH/6Sko+KXCEdSkzepVprhObH/8leoP3TT8hI1H9qEbGv7g7NbrkK6ccL0E4LJ7Pf71O1+WU5cQmAFO4BpwvrxN91yKEA+UDC9brn74rPsHU1TbO/gI/ori+hZ1HrdndPux5VhYYM0zaYTK03wHHIKUk84Ljw8rH6SZO9qqDe1UU7IJ+BHPOnpGVL4NQwbfKFRP/t/vCZmZydD8dYKklWt1rI+IEHQSuLdz7GPLJga/BPN/htlbCL/VAgALZKWN5l3WZILrwsA25idZCn58k4WmorhHbZYoA=
  file:
    - dist/Lifter Proxy-mac.zip
  skip_cleanup: true
  on:
    repo: kyo-ago/lifter
    tags: true
